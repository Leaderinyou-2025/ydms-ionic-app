<app-header
  [pageTitle]="TranslateKeys.TITLE_FRIENDS"
  backgroundColor="linear-gradient(to right, #0a1f5c, #4a2a8c)"
  [animeImage]="animeImage"
  [searchbar]="searchbar"
  (inputSearch)="onSearchChange($event)">
</app-header>

<ion-content class="bg-gradient-to-r from-[#0a1f5c] to-[#4a2a8c]">
  <!-- Pull to refresh -->
  <ion-refresher mode="md" slot="fixed" (ionRefresh)="doRefresh($event)">
    <ion-refresher-content></ion-refresher-content>
  </ion-refresher>

  <div class="flex flex-col h-full pb-5">
    <div class="flex justify-between px-4 pt-4 pb-2.5 text-gray-800">
      <div class="text-sm font-bold">{{ TranslateKeys.TITLE_TOTAL_FRIENDS | translate }}: {{ totalFriends }}</div>
      <div class="text-sm font-bold">{{ TranslateKeys.TITLE_CLOSE_FRIENDS | translate }}</div>
    </div>
    <div class="flex-1 overflow-auto px-2 mb-4">
      <ion-list class="w-full bg-transparent">
        <ion-item *ngFor="let friend of friends" routerLink="{{friend.id}}"
                  lines="none" detail="false" class="w-full mb-1 border-b border-gray-200 friend-item">
          <ion-avatar slot="start" class="w-[42px] h-[42px] mr-2.5">
            <div class="w-full h-full overflow-hidden rounded-full border-2 border-blue-500">
              <ion-img [src]="friend.avatar" alt="Friend avatar" class="object-cover w-full h-full"></ion-img>
            </div>
          </ion-avatar>
          <div class="flex flex-col">
            <div class="text-sm font-medium text-gray-800">
              {{ friend.name }}
            </div>
            <div class="text-xs text-gray-500 mt-1">
              {{ friend.nickname }}
            </div>
          </div>
          <div slot="end" class="flex flex-col items-end min-w-[60px]">
            <div class="flex items-center text-red-500">
              <ion-icon name="heart" class="text-lg text-red-500"></ion-icon>
              <span class="ml-1 text-sm font-semibold">{{ friend.friendly_point }}</span>
            </div>
          </div>
        </ion-item>
      </ion-list>

      <!-- Infinite scroll for pagination -->
      <ion-infinite-scroll threshold="100px" (ionInfinite)="loadMore($event)">
        <ion-infinite-scroll-content loadingSpinner="bubbles"></ion-infinite-scroll-content>
      </ion-infinite-scroll>
    </div>
    <ion-button expand="block" color="primary" class="h-11 mx-4 text-sm font-semibold uppercase">
      {{ TranslateKeys.TITLE_ADD_FRIEND | translate }}
    </ion-button>
  </div>
</ion-content>

<app-footer></app-footer>
