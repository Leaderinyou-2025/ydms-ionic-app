

<div class="flex flex-col h-full bg-white">
  <!-- Topic filter buttons with horizontal scrolling -->
  <div class="px-2 py-2">
    <div class="flex overflow-x-auto scrollbar-hide">
      <ion-button
        [fill]="selectedTopic === filter.topic ? 'solid' : 'outline'"
        *ngFor="let filter of topicFilters"
        shape="round"
        [color]="selectedTopic === filter.topic ? 'primary' : 'medium'"
        class="flex-shrink-0 mx-1"
        (click)="onTopicChange(filter.topic)">
        {{ filter.translationKey | translate }}
      </ion-button>
    </div>
  </div>

  <!-- Resource list -->
  <div class="flex-1 overflow-auto px-4 pb-4">
    <!-- Pull to refresh -->
    <ion-refresher slot="fixed" (ionRefresh)="doRefresh($event)">
      <ion-refresher-content></ion-refresher-content>
    </ion-refresher>

    <!-- Loading indicator -->
    <div *ngIf="isLoading && resources.length === 0" class="flex justify-center items-center h-32">
      <ion-spinner name="crescent"></ion-spinner>
    </div>

    <!-- Empty state -->
    <div *ngIf="!isLoading && resources.length === 0" class="flex flex-col justify-center items-center h-32 text-gray-500">
      <ion-icon name="search-outline" class="text-4xl mb-2"></ion-icon>
      <p>{{ TranslateKeys.RESOURCE_NO_RESOURCES_FOUND | translate }}</p>
    </div>

    <!-- Resource grid -->
    <div class="grid grid-cols-2 gap-4">
      <div *ngFor="let resource of resources"
           class="rounded-lg overflow-hidden shadow-md transition-transform active:scale-[0.98] flex flex-col h-[250px]"
           [ngClass]="resource.type === ResourceType.VIDEO ? 'border-l-2 border-l-red-500' : 'border-l-2 border-l-blue-500'"
           (click)="onResourceSelect(resource)">
        <div class="relative">
          <img [src]="resource.thumbnailUrl" alt="{{ resource.title }}" class="w-full h-32 object-cover">
          <div class="absolute top-2 right-2 bg-black bg-opacity-70 text-white rounded-full p-1">
            <ion-icon [name]="getResourceTypeIcon(resource.type)" class="text-lg"></ion-icon>
          </div>
        </div>
        <div class="p-3 flex flex-col justify-between flex-1">
          <h3 class="font-semibold text-sm overflow-hidden line-clamp-2 mb-1">{{ resource.title }}</h3>
          <p class="text-xs text-gray-600 overflow-hidden line-clamp-2">{{ resource.shortDescription }}</p>
          <div class="flex justify-between items-center mt-2 text-xs text-gray-500">
            <span class="flex items-center">
              <ion-icon [name]="getResourceTopicIcon(resource.topic)" class="mr-1"></ion-icon>
              {{ getResourceTopicTranslation(resource.topic) | translate }}
            </span>
            <span class="flex items-center">
              <ion-icon name="eye-outline" class="mr-1"></ion-icon>
              {{ resource.viewCount }}
            </span>
          </div>
        </div>
      </div>
    </div>

    <!-- Infinite scroll -->
    <ion-infinite-scroll threshold="100px" (ionInfinite)="loadMore($event)" [disabled]="!hasMoreData">
      <ion-infinite-scroll-content loadingSpinner="bubbles" [loadingText]="TranslateKeys.RESOURCE_LOADING_MORE | translate">
      </ion-infinite-scroll-content>
    </ion-infinite-scroll>
  </div>
</div>
